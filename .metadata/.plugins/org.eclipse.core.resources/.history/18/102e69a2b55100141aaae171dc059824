var latitude;
var longitude;
//var reverseGeocoder;
/*
var geolocation = function(){
	
	Ti.Geolocation.purpose = "Your location is needed to determine current location."; 
	Ti.Geolocation.accuracy = Ti.Geolocation.ACCURACY_BEST;
	Ti.Geolocation.getCurrentPosition(function(e){
		latitude = e.coords.latitude;
		longitude = e.coords.longitude;
		var locLabel = Ti.UI.createLabel({
			color: '#fff',
			text: 'Latitude: ' + latitude + ', Longitude: ' + longitude,
			top: '10%',
			height: Ti.UI.SIZE,
			textAlign: 'center',
			font: {
				fontSize: '12',
				fontWeight: 'bold'
			}
		});
		mainView.add(locLabel);  
	}); 
}; 
exports.geolocation = geolocation; */
/*
 // try to get address
    var cityLocation = function(){
    	Titanium.Geolocation.reverseGeocoder(latitude,longitude, function(e) {
        var city;
       
        if (e.success) {
            var places = evt.places;
            if (places && places.length) {
                city = places[0].city;
            } else {
                address = "No address found";
            }
        }
        
    });
 };   
exports.cityLocation = cityLocation; 
*/
var geolocation = function(){
var addrUrl = "http://maps.googleapis.com/maps/api/geocode/json?sensor=true&latlng="+latitude+","+longitude;
/* web-service call */
var addrReq = Titanium.Network.createHTTPClient();
addrReq.open("GET",addrUrl);
addrReq.send(null);
  
addrReq.onload = function()
{
    var response = JSON.parse(this.responseText);
  
    if(response.status == "OK"){
        var resLen = response.results[0].address_components.length;
        for(var i=0; i < resLen; i++) {
            switch (response.results[0].address_components[i].types[0])
            {
                case "street_number":
                    Ti.API.info("street number : "+response.results[0].address_components[i].long_name);
                    break;
                case "route":
                    Ti.API.info("street name : "+response.results[0].address_components[i].long_name);
                    break;
                case "locality":
                    Ti.API.info("city name : "+response.results[0].address_components[i].long_name);
                    break;
                case "administrative_area_level_1":
                    Ti.API.info("state name : "+response.results[0].address_components[i].long_name);
                    break;
                case "postal_code":
                    Ti.API.info("zip code : "+response.results[0].address_components[i].long_name);
                    break;
                case "country":
                    Ti.API.info("country name : "+response.results[0].address_components[i].long_name);
                    break;
                }
        }
    }else{
        showAlert('','Unable to find Address');
    }
  
};

exports.geoLocation = geoLocation;