var Component = require('cows');
Component.components();
var Cloud = require('cloud');
var geo = require('geoLocation');
geo.geolocation();


var myWeather = 'http://api.wunderground.com/api/c8aa6df478360a59/forecast/q/autoip.json';

//create remote response
var remoteResponse = function(e) {
	if (Ti.Network.online) {
		var json = JSON.parse(this.responseText);
		Cloud.loginAppUser(json);
		var hiTemp = json.forecast.simpleforecast.forecastday[0].high.fahrenheit;
		var loTemp = json.forecast.simpleforecast.forecastday[0].low.fahrenheit;
		var humidity = json.forecast.simpleforecast.forecastday[0].avehumidity;
		var dayconditions = json.forecast.simpleforecast.forecastday[0].conditions;
		//var hiTemp = json.forecast.simpleforecast.forecastday[0].high.fahrenheit;
		var day = json.forecast.txt_forecast.forecastday[0].title;
		var forecast = json.forecast.txt_forecast.forecastday[0].fcttext;
		var weatherImage = json.forecast.txt_forecast.forecastday[0].icon_url;
		var daytwo = json.forecast.txt_forecast.forecastday[2].fcttext;
		var daytwoTitle = json.forecast.txt_forecast.forecastday[2].title;
		var daytwoImage = json.forecast.txt_forecast.forecastday[2].icon_url;
		var daythree = json.forecast.txt_forecast.forecastday[4].fcttext;
		var daythreeTitle = json.forecast.txt_forecast.forecastday[4].title;
		var daythreeImage = json.forecast.txt_forecast.forecastday[4].icon_url;
		var dayfour = json.forecast.txt_forecast.forecastday[6].fcttext;
		var dayfourTitle = json.forecast.txt_forecast.forecastday[6].title;
		var dayfourImage = json.forecast.txt_forecast.forecastday[4].icon_url;
		var todaysdate = json.forecast.simpleforecast.forecastday[0].date.monthname + " " + json.forecast.simpleforecast.forecastday[0].date.day;
		
		
	} else {
		Ti.API.debug('Status: ' + this.status);
		Ti.API.debug('Response: ' + this.responseText);
		Ti.API.debug('Error: ' + e.error);
		alert('There was an error retreiving data.  Please try again later.');
	};
};
var remoteError = function(e) {
	Ti.API.debug('Status: ' + this.status);
	Ti.API.debug('Response: ' + this.responseText);
	Ti.API.debug('Error: ' + e.error);
	alert('You must be connected to a network.');
};
var xhr = Ti.Network.createHTTPClient({
	onload : remoteResponse,
	onerror : remoteError,
	timeout : 50000
});
xhr.open('GET', myWeather);
xhr.send();


